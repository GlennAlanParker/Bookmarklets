javascript:(function(){function S(e){return e.replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim()}function E(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var T=document.title,U=location.href,H=location.host,L=[...document.getElementsByTagName("a")].map(e=>{var t=e.href,n=e.textContent.trim()||"No Text",i=e.querySelector("img,picture source"),r=e.outerHTML.trim(),m=r.replace(/</g,"&lt;").replace(/>/g,"&gt;"),o;if(i){var s=i.getAttribute("src")||i.getAttribute("srcset")||t;s&&0!==s.indexOf("http")&&(s=new URL(s,location.href).href);var c=s.split("?")[0].split("#")[0],d=c.split("/").pop();o='Image Link: <a href="'+s+'" target="_blank">'+d+"</a><br>"+c+"<br><br><a href='"+t+"' target='_blank'>"+n+"</a><br>"+t}else o="<a href='"+t+"' target='_blank'>"+n+"</a><br>"+t;return{text:n,href:t,colOriginal:o,colText:S(o),markupHTML:m,rawMarkup:r}}),W=window.open();W.document.write('<!doctype html><html><head><title>Links – '+T+'</title></head><body><div id="header"><h1>Link Inventory<br><small>'+T+'</small><br><small>'+U+'</small></h1><div id="controls"></div></div><table id="tbl"><thead><tr><th>#</th><th>Link</th><th>HTML</th></tr></thead><tbody></tbody></table><div id="backToTop">↑</div></body></html>');W.document.close();var D=W.document,J=D.createElement("script");J.src="https://code.jquery.com/jquery-3.7.1.min.js";J.onload=function(){var $=W.jQuery.noConflict(!0),A=L.slice(),R=D.getElementById("header");D.getElementById("controls").innerHTML='<input id="search" placeholder="Search all columns…"><select id="sort"><option value="">Sort</option><option value="text-asc">Text A–Z</option><option value="text-desc">Text Z–A</option><option value="url-asc">URL A–Z</option><option value="url-desc">URL Z–A</option></select><select id="filter"><option value="">Filter</option><option value="all">All</option><option value="internal">Internal</option><option value="external">External</option></select>';var C=D.createElement("style");C.textContent="body{font-family:Arial;margin:0;text-align:center}#header{position:fixed;top:0;left:0;width:100%;background:#fff;z-index:1000;padding:12px 0;box-shadow:0 2px 6px rgba(0,0,0,.1)}input,select{padding:6px;margin:6px;font-size:1em}#tbl{width:90%;margin:0 auto;border-collapse:separate;border-spacing:0 10px}thead th{position:sticky;background:#f2f2f2;z-index:500;text-align:left}td{text-align:left;vertical-align:top;padding:12px 6px}td:first-child{text-align:right}.highlight{background:yellow;pointer-events:none}.markup{font-family:Consolas,monospace;background:#fafafa;padding:4px;display:block;white-space:pre-wrap;word-break:break-all}#backToTop{position:fixed;bottom:24px;right:24px;width:44px;height:44px;border-radius:50%;background:#333;color:#fff;font-size:24px;display:flex;align-items:center;justify-content:center;cursor:pointer;opacity:0;transition:opacity .3s;z-index:9999}#backToTop:hover{background:#000}";D.head.appendChild(C);function O(){var e=R.offsetHeight;D.body.style.paddingTop=e+"px",D.querySelectorAll("thead th").forEach(t=>t.style.top=e+"px")}O(),W.addEventListener("resize",O);function HN(e,t){if(!t)return;var n=new RegExp(t.split(/\s+/).map(E).join("|"),"gi");!function r(o){if(3===o.nodeType){var i=o.parentNode,c=o.textContent;if(n.test(c)){var s=D.createElement("span");s.innerHTML=c.replace(n,e=>'<span class="highlight">'+e+"</span>"),i.replaceChild(s,o)}}else 1===o.nodeType&&o.childNodes.length&&[...o.childNodes].forEach(r)}(e)}function HM(e,t){if(!t)return e;var n=new RegExp(t.split(/\s+/).map(E).join("|"),"gi");return e.replace(n,e=>'<span class="highlight">'+e+"</span>")}function RENDER(t,n){var r=D.querySelector("#tbl tbody");r.innerHTML="",t.forEach((e,t)=>{var n=D.createElement("tr");n.innerHTML="<td>"+(t+1)+".</td><td class='linkcol'>"+e.colOriginal+"</td><td class='markupcol'>"+e.markupHTML+"</td>",r.appendChild(n)}),r.querySelectorAll("td.linkcol").forEach(e=>HN(e,n)),r.querySelectorAll("td.markupcol").forEach(e=>e.innerHTML=HM(e.innerHTML,n))}RENDER(A,""),$("#search",D).on("input",function(){var t=this.value.toLowerCase().trim(),n=t.split(/\s+/).filter(Boolean);RENDER(A.filter(e=>{var t=[e.text,e.href,e.colText,e.rawMarkup].join(" ").toLowerCase();return n.every(e=>t.includes(e))}),this.value)}),$("#sort",D).on("change",function(){var t=this.value;"text-asc"===t&&A.sort((e,t)=>e.text.localeCompare(t.text)),"text-desc"===t&&A.sort((e,t)=>t.text.localeCompare(e.text)),"url-asc"===t&&A.sort((e,t)=>e.href.localeCompare(t.href)),"url-desc"===t&&A.sort((e,t)=>t.href.localeCompare(e.href)),RENDER(A,$("#search",D).val())}),$("#filter",D).on("change",function(){var t=this.value;"all"===t&&(A=L.slice()),"internal"===t&&(A=L.filter(e=>e.href.includes(H))),"external"===t&&(A=L.filter(e=>!e.href.includes(H))),RENDER(A,$("#search",D).val())});var B=D.getElementById("backToTop");W.addEventListener("scroll",()=>B.style.opacity=W.scrollY>300?1:0),B.onclick=()=>W.scrollTo({top:0,behavior:"smooth"})};D.head.appendChild(J)})();
