javascript:(function(){var t=document.title,u=location.href,h=location.host,l=[...document.getElementsByTagName("a")].map(e=>{var t=e.href,n=e.textContent.trim()||"No Text",r=e.querySelector("img,picture source"),o,a=e.outerHTML.trim(),i=a.replace(/</g,"&lt;").replace(/>/g,"&gt;");if(r){var s=r.getAttribute("src")||r.getAttribute("srcset")||t;s&&0!==s.indexOf("http")&&(s=new URL(s,location.href).href);var c=s.split("?")[0].split("#")[0],d=c.split("/").pop();o='Image Link: <a href="'+s+'" target="_blank">'+d+"</a><br>"+c+"<br><br><a href='"+t+"' target='_blank'>"+n+"</a><br>"+t}else o="<a href='"+t+"' target='_blank'>"+n+"</a><br>"+t;return{text:n,href:t,colOriginal:o,markupHTML:i,rawMarkup:a}});var w=window.open();w.document.write('<!doctype html><html><head><title>Links – '+t+'</title></head><body><div id="header"><h1>Link Inventory<br><small>'+t+'</small><br><small>'+u+'</small></h1><div id="controls"></div></div><table id="tbl"><thead><tr><th>#</th><th>Link</th><th>HTML</th></tr></thead><tbody></tbody></table><div id="backToTop">↑</div></body></html>');w.document.close();var d=w.document,j=d.createElement("script");j.src="https://code.jquery.com/jquery-3.7.1.min.js";j.onload=function(){var $=w.jQuery.noConflict(!0),e=l.slice(),H=d.getElementById("header");d.getElementById("controls").innerHTML='<input id="search" placeholder="Search all columns…"><select id="sort"><option value="">Sort</option><option value="text-asc">Text A–Z</option><option value="text-desc">Text Z–A</option><option value="url-asc">URL A–Z</option><option value="url-desc">URL Z–A</option></select><select id="filter"><option value="">Filter</option><option value="all">All</option><option value="internal">Internal</option><option value="external">External</option></select>';var n=d.createElement("style");n.textContent="body{font-family:Arial;margin:0;text-align:center}#header{position:fixed;top:0;left:0;width:100%;background:#fff;z-index:1000;padding:12px 0;box-shadow:0 2px 6px rgba(0,0,0,.1)}input,select{padding:6px;margin:6px;font-size:1em}table{width:90%;margin:auto;border-collapse:separate;border-spacing:0 10px}thead th{position:sticky;background:#f2f2f2;z-index:500}th{text-align:center}td{text-align:left;vertical-align:top;padding:12px 6px}td:first-child{text-align:right}.highlight{background:yellow;pointer-events:none}.markup{font-family:Consolas,monospace;background:#fafafa;padding:4px;display:block;white-space:pre-wrap;word-break:break-all}#backToTop{position:fixed;bottom:24px;right:24px;width:44px;height:44px;border-radius:50%;background:#333;color:#fff;font-size:24px;display:flex;align-items:center;justify-content:center;cursor:pointer;opacity:0;transition:opacity .3s;z-index:9999}#backToTop:hover{background:#000}";d.head.appendChild(n);function setOffset(){var h=H.offsetHeight;d.body.style.paddingTop=h+"px";d.querySelectorAll("thead th").forEach(th=>th.style.top=h+"px")}setOffset();w.addEventListener("resize",setOffset);function r(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function o(e,t){if(!t||!t.trim())return;var n=new RegExp(t.trim().split(/\s+/).map(r).join("|"),"gi");!function r(o){3===o.nodeType?(function(){var r=o.parentNode,i=o.textContent;if(n.test(i)){var a=document.createElement("span");a.innerHTML=i.replace(n,e=>'<span class="highlight">'+e+"</span>"),r.replaceChild(a,o)}}()):1===o.nodeType&&o.childNodes.length&&Array.from(o.childNodes).forEach(r)}(e)}function a(e,t){if(!t||!t.trim())return e;var n=new RegExp(t.trim().split(/\s+/).map(r).join("|"),"gi");return e.replace(n,e=>'<span class="highlight">'+e+"</span>")}function i(t,n){var r=d.querySelector("#tbl tbody");r.innerHTML="",t.forEach((e,t)=>{var n=d.createElement("tr");n.innerHTML="<td>"+(t+1)+".</td><td class='linkcol'>"+e.colOriginal+"</td><td class='markupcol'>"+e.markupHTML+"</td>",r.appendChild(n)}),r.querySelectorAll("td.linkcol").forEach(e=>o(e,n)),r.querySelectorAll("td.markupcol").forEach(e=>{e.innerHTML=a(e.innerHTML,n)})}i(e,null),$("#search",d).on("input",function(){var t=this.value.toLowerCase();i(e.filter(e=>e.text.toLowerCase().includes(t)||e.href.toLowerCase().includes(t)||e.rawMarkup.toLowerCase().includes(t)),this.value)}),$("#sort",d).on("change",function(){var t=this.value;"text-asc"===t&&e.sort((e,t)=>e.text.localeCompare(t.text)),"text-desc"===t&&e.sort((e,t)=>t.text.localeCompare(e.text)),"url-asc"===t&&e.sort((e,t)=>e.href.localeCompare(t.href)),"url-desc"===t&&e.sort((e,t)=>t.href.localeCompare(e.href)),i(e,$("#search",d).val())}),$("#filter",d).on("change",function(){var t=this.value;"all"===t&&(e=l.slice()),"internal"===t&&(e=l.filter(e=>e.href.includes(h))),"external"===t&&(e=l.filter(e=>!e.href.includes(h))),i(e,$("#search",d).val())});var b=d.getElementById("backToTop");w.addEventListener("scroll",()=>{b.style.opacity=w.scrollY>300?1:0}),b.onclick=()=>w.scrollTo({top:0,behavior:"smooth"})};d.head.appendChild(j)})();
